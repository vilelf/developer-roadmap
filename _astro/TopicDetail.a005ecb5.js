import{p as L,h as i,_ as D,F as A}from"./hooks.module.a845df0c.js";import{C as G}from"./close.3a539829.js";import{S as E}from"./spinner.164b1eeb.js";import{u as M,a as N}from"./use-outside-click.bd11f1f3.js";import{h as _,a as z}from"./http.20668c64.js";import{i as q}from"./jwt.f0e0aa9c.js";import{g as O,u as H,r as U,a as F,i as K}from"./resource-progress.e020b4b4.js";import{p as $,s as Q}from"./page.e7291a86.js";import{s as R}from"./popup.a359f713.js";import{o as e}from"./jsxRuntime.module.8b00cb04.js";import{k as W}from"./preact.module.f1575aff.js";function J(u){L(()=>{function n(a){const{resourceType:r,resourceId:s,topicId:c}=a.detail;u({resourceType:r,resourceId:s,topicId:c})}return window.addEventListener("roadmap.topic.click",n),window.addEventListener("best-practice.topic.click",n),()=>{window.removeEventListener("roadmap.topic.click",n),window.removeEventListener("best-practice.topic.click",n)}},[])}function V(u){L(()=>{function n(a){const{resourceType:r,resourceId:s,topicId:c}=a.detail;u({resourceType:r,resourceId:s,topicId:c})}return window.addEventListener("best-practice.topic.toggle",n),()=>{window.removeEventListener("best-practice.topic.toggle",n)}},[])}const X="/_astro/down.93d0ce97.svg",T={done:"bg-green-500",learning:"bg-yellow-500",pending:"bg-gray-300",skipped:"bg-black"};function Y(u){const{topicId:n,resourceId:a,resourceType:r,onClose:s}=u,[c,m]=i(!0),[t,h]=i("pending"),[f,o]=i(!1),p=D(null);M(p,()=>{o(!1)});const d=A(()=>!q(),[]);L(()=>{!n||!a||!r||(m(!0),O({topicId:n,resourceId:a,resourceType:r}).then(y=>{m(!1),h(y)}).catch(console.error))},[n,a,r]),N("d",()=>{if(t==="done"){s();return}l("done")},[t]),N("l",()=>{if(t==="learning"){s();return}l("learning")},[t]),N("s",()=>{if(t==="skipped"){s();return}l("skipped")},[t]),N("r",()=>{if(console.log(t),t==="pending"){s();return}l("pending")},[t]);const l=y=>{if(d){s(),R();return}m(!0),H({topicId:n,resourceId:a,resourceType:r},y).then(()=>{h(y),s(),U(n,y),F()}).catch(S=>{alert(S.message),console.error(S)}).finally(()=>{m(!1)})},k=["pending","learning","done"].includes(t),C=["skipped","pending","learning"].includes(t),w=["done","skipped","pending"].includes(t),g=["skipped","done","learning"].includes(t);return c?e("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e("img",{alt:"Check",class:"h-4 w-4 animate-spin",src:E}),e("span",{className:"ml-2",children:"Updating Status.."})]}):e("div",{className:"relative inline-flex rounded-md border border-gray-300",children:[e("span",{className:"inline-flex cursor-default items-center  p-1 px-2 text-sm text-black",children:[e("span",{class:"flex h-2 w-2",children:e("span",{class:`relative inline-flex h-2 w-2 rounded-full ${T[t]}`})}),e("span",{className:"ml-2 capitalize",children:t==="learning"?"In Progress":t})]}),e("button",{className:"inline-flex cursor-pointer items-center rounded-br-md rounded-tr-md border-l border-l-gray-300 bg-gray-100 p-1 px-2 text-sm text-black hover:bg-gray-200",onClick:()=>o(!0),children:[e("span",{className:"mr-0.5",children:"Update Status"}),e("img",{alt:"Check",class:"h-4 w-4",src:X})]}),f&&e("div",{className:"absolute right-0 top-full mt-1 flex min-w-[160px] flex-col divide-y rounded-md border border-gray-200 bg-white shadow-md [&>button:first-child]:rounded-t-md [&>button:last-child]:rounded-b-md",ref:p,children:[C&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("done"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${T.done}`}),"Done"]}),e("span",{class:"text-xs text-gray-500",children:"D"})]}),w&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("learning"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${T.learning}`}),"In Progress"]}),e("span",{class:"text-xs text-gray-500",children:"L"})]}),g&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("pending"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${T.pending}`}),"Reset"]}),e("span",{class:"text-xs text-gray-500",children:"R"})]}),k&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("skipped"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${T.skipped}`}),"Skip"]}),e("span",{class:"text-xs text-gray-500",children:"S"})]})]})]})}function Z(u){const{isLast:n,totalCount:a,onAdd:r,onRemove:s,onChange:c,id:m,title:t,link:h}=u,f=D(null),[o,p]=i(""),[d,l]=i(t),[k,C]=i(h);L(()=>{f?.current&&f.current.focus()},[]),L(()=>{c({id:m,title:d,link:k})},[d,k]);const w=n&&a<5;return e("div",{className:"relative mb-3 rounded-md border p-3",children:[e("p",{className:`mb-1 text-xs uppercase ${o==="title"?"text-black":"text-gray-400"}`,children:"Resource Title"}),e("input",{ref:f,type:"text",required:!0,className:"block w-full rounded-md border p-2 text-sm focus:border-gray-400 focus:outline-none",placeholder:"e.g. Introduction to RESTful APIs",onFocus:()=>p("title"),onBlur:()=>p(""),onChange:g=>l(g.target.value)}),e("p",{className:`mb-1 mt-3 text-xs uppercase ${o==="link"?"text-black":"text-gray-400"}`,children:"Resource Link"}),e("input",{type:"url",required:!0,className:"block w-full rounded-md border p-2 text-sm focus:border-gray-400 focus:outline-none",placeholder:"e.g. https://roadmap.sh/guides/some-url",onFocus:()=>p("link"),onBlur:()=>p(""),onChange:g=>C(g.target.value)}),e("div",{className:"mb-0 mt-3 flex gap-3",children:[a!==1&&e("button",{onClick:g=>{g.preventDefault(),s()},className:"rounded-md text-sm font-semibold text-red-500 underline underline-offset-2 hover:text-red-800",children:"- Remove Link"}),w&&e("button",{onClick:g=>{g.preventDefault(),r()},className:"rounded-md text-sm font-semibold text-gray-600 underline underline-offset-2 hover:text-black",children:"+ Add another Link"})]})]})}function ee(u){const{onClose:n,resourceType:a,resourceId:r,topicId:s}=u,[c,m]=i(!1),[t,h]=i([{id:new Date().getTime(),title:"",link:""}]);async function f(o){o.preventDefault(),m(!0);const{response:p,error:d}=await _("https://api.roadmap.sh/v1-contribute-link",{resourceType:a,resourceId:r,topicId:s,links:t});if(m(!1),!p||d){alert(d?.message||"Something went wrong. Please try again.");return}n("Thanks for your contribution! We will review it shortly.")}return e("div",{children:[e("div",{className:"mb-2 mt-2 rounded-md border bg-gray-100 p-3",children:[e("h1",{className:"mb-2 text-2xl font-bold",children:"Guidelines"}),e("ul",{class:"flex flex-col gap-1 text-sm text-gray-700",children:[e("li",{children:"Content should only be in English."}),e("li",{children:"Do not add things you have not evaluated personally."}),e("li",{children:"It should strictly be relevant to the topic."}),e("li",{children:"It should not be paid or behind a signup."}),e("li",{children:"Quality over quantity. Smaller set of quality links is preferred."})]})]}),e("form",{onSubmit:f,children:[t.map((o,p)=>e(Z,{id:o.id,title:o.title,link:o.link,isLast:p===t.length-1,totalCount:t.length,onChange:d=>{h(t.map(l=>l.id===o.id?d:l))},onRemove:()=>{h(t.filter(d=>d.id!==o.id))},onAdd:()=>{h([...t,{id:new Date().getTime(),title:"",link:""}])}},o.id)),e("div",{className:"flex gap-2",children:[e("button",{disabled:c,type:"submit",className:"block w-full rounded-md bg-gray-800 p-2 text-sm text-white hover:bg-black disabled:cursor-not-allowed disabled:bg-gray-400",children:c?"Please wait ...":"Submit"}),e("button",{className:"block w-full rounded-md border border-red-500 p-2 text-sm text-red-600 hover:bg-red-600 hover:text-white",onClick:o=>{o.preventDefault(),n()},children:"Cancel"})]})]})]})}function me(){const[u,n]=i(""),[a,r]=i(!1),[s,c]=i(!1),[m,t]=i(!1),[h,f]=i(""),[o,p]=i(""),d=A(()=>!q(),[]),l=D(null),[k,C]=i(""),[w,g]=i(""),[y,S]=i("roadmap");return M(l,()=>{r(!1),t(!1)}),N("Escape",()=>{r(!1),t(!1)}),V(({topicId:b,resourceType:I,resourceId:v})=>{if(d){R();return}$.set("Updating"),K({topicId:b,resourceId:v,resourceType:I}).then(x=>H({topicId:b,resourceId:v,resourceType:I},x?"pending":"done")).then(({done:x=[]})=>{U(b,x.includes(b)?"done":"pending"),F()}).catch(x=>{alert(x.message),console.error(x)}).finally(()=>{$.set("")})}),J(({topicId:b,resourceType:I,resourceId:v})=>{c(!0),r(!0),Q.set(!0),n(""),C(b),S(I),g(v);const x=b.replaceAll(":","/"),j=I==="roadmap"?`/${v}/${x}`:`/best-practices/${v}/${x}`;z(j,{},{headers:{Accept:"text/html"}}).then(({response:P})=>{if(!P){f("Topic not found.");return}const B=new DOMParser().parseFromString(P,"text/html")?.getElementById("main-content")?.outerHTML||"";c(!1),p(B)}).catch(P=>{f("Something went wrong. Please try again later."),c(!1)})}),a?e("div",{children:[e("div",{ref:l,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 sm:max-w-[600px] sm:p-6",children:[s&&e("div",{className:"flex w-full justify-center",children:e("img",{src:E,alt:"Loading",className:"h-6 w-6 animate-spin fill-blue-600 text-gray-200 sm:h-12 sm:w-12"})}),!s&&m&&e(ee,{resourceType:y,resourceId:w,topicId:k,onClose:b=>{b&&n(b),t(!1)}}),!m&&!s&&!h&&e(W,{children:[e("div",{className:"mb-2",children:[e(Y,{topicId:k,resourceId:w,resourceType:y,onClose:()=>{r(!1),t(!1)}}),e("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>{r(!1),t(!1)},children:e("img",{alt:"Close",class:"h-5 w-5",src:G})})]}),e("div",{id:"topic-content",className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",dangerouslySetInnerHTML:{__html:o}}),e("div",{className:"mt-8 flex-1 border-t",children:[e("p",{class:"mb-2 mt-2 text-sm leading-relaxed text-gray-400",children:["Help others learn by submitting links to learn more about this topic"," "]}),e("button",{onClick:()=>{if(d){r(!1),R();return}t(!0)},disabled:!!u,className:"block w-full rounded-md bg-gray-800 p-2 text-sm text-white transition-colors hover:bg-black hover:text-white disabled:bg-green-200 disabled:text-black",children:u||"Submit a Link"})]})]})]}),e("div",{class:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]}):null}export{me as TopicDetail};
